<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="repo-name" content="{{REPO_NAME}}" />
    <title>Waffle Map</title>
    <script>
      // GitHub Pages SPA workaround
      // Redirect to index.html with the path stored in sessionStorage
      (function () {
        var repoMeta = document.querySelector('meta[name="repo-name"]');
        var repo = repoMeta ? repoMeta.getAttribute("content") : "";

        var pathSegments = location.pathname.split("/").filter(Boolean);

        // If repo name is set and matches the first path segment, remove it
        if (repo && pathSegments[0] === repo) {
          pathSegments.shift();
        }

        if (pathSegments.length > 0) {
          sessionStorage.setItem("redirect", "/" + pathSegments.join("/"));
        }

        // Redirect to the base URL (with repo prefix if set)
        var baseUrl = repo ? "/" + repo + "/" : "/";
        location.replace(baseUrl);
      })();
    </script>
  </head>
  <body></body>
</html>
